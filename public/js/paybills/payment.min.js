!function(e,a,t){e.payBills=function(){function e(){function e(){var e=l(),t="";if("gas"==e)t="form-pay-gas-bill";else if("electricity"==e)t="form-pay-electricity-bill";else{if("broadband"!=e)return!1;t="form-pay-bb-bill"}if(""!=t){var r=s({data:{elem:t+" .form-group",isAmount:"0"}});if(1==r||0==r){var n=!1;a("#"+t+" .form-group").each(function(){a(".form-group").hasClass("has-error")>0&&(n=!0)}),n||i()}}}function l(){return a("body.home").length>0?_vasLink=a(".unique").parents(".recharge-bills-home").find(".nav-tabs li.active a").attr("href"):(_innerPageLink=a(".unique").parents(".recharge-bills").find(".nav-tabs li.active a").attr("href"),-1!=_innerPageLink.indexOf("gas")&&(_vasLink="#gas"),-1!=_innerPageLink.indexOf("electricity")&&(_vasLink="#electricity"),-1!=_innerPageLink.indexOf("broadband")&&(_vasLink="#broadband")),_vasLink!=t?_vasLink.substring(1):"1"}function i(){a(".popup-loader").removeClass("hide"),a(".biller_bill_fetch a").addClass("disabled"),a(".biller_bill_fetch").parents(".form-group").find(".help-block").text(""),_vasService=l(),_operatorId="","gas"==_vasService?(_operatorId="gasbillpayment-operator",_formId="form-pay-gas-bill",_formName="GasBillPayment"):"electricity"==_vasService&&(_operatorId="electricitybillpayment-operator",_formId="form-pay-electricity-bill",_formName="ElectricityBillPayment"),_operatorVall=a("#"+_operatorId).val();var e=new FormData(a("#"+_formId)[0]);e.append("billerFields",b),e.append("formName",_formName),""!=_operatorVall&&a.ajax({url:"/paybills/gas-bill-payment/fetch-biller-bill",method:"post",data:e,contentType:!1,cache:!1,processData:!1,success:function(e){a(".popup-loader").addClass("hide"),a(".biller_bill_fetch a").removeClass("disabled"),result=a.parseJSON(e),"success"==result.status?(a(".biller_bill_fetch").parents(".form-group").find(".help-block").text(""),a(".biller_bill_fetch").siblings("input").val(result.amount)):a(".biller_bill_fetch").parents(".form-group").find(".help-block").html("<p style='color: #f13a3e'>"+result.msg+"</p>")}})}function r(e,t){a(".biller_bill_fetch a").text(""),t=t||"",t?_id=t.val():_id=a(this).val(),_destination_div=e.data.container;var l=a("#electricitybillpayment-operator :selected").text(),i=a("#gasbillpayment-operator :selected").text(),r=a("#broadbandbillpayment-operator :selected").text();a("#hide_ele_operator").val(l),a("#hide_gas_operator").val(i),a("#hidden_bb_operator").val(r),$selectedOperator=a("#broadbandbillpayment-operator :selected").text(),""!=_id?(b="",a.ajax({url:"/paybills/electricity-bill-payment/get-biller-question",method:"post",data:{id:_id,_csrf:a("input[name=_csrf]").val()},success:function(e){result=a.parseJSON(e);var t="";if("success"==result.status){for(var l="",i=1,r=0;r<result.data.length;r++){var n='data="'+result.data[r].display_value+'"';if(result.data[r].max_length&&(t="cls-mxlen",n+='maxlength="'+result.data[r].max_length+'"'),result.data[r].min_length&&(n+='minlength="'+result.data[r].min_length+'"'),result.data[r].min_length){n+='is_numeric="'+result.data[r].is_numeric+'"';var s="";if(1==result.data[r].is_numeric)var o="integerOnly";else{var o="";s="nosubmit"}}"electricity_amount"==_destination_div?_model="ElectricityBillPayment":"broadband_amount"==_destination_div?_model="BroadbandBillPayment":"gas_amount"==_destination_div?_model="GasBillPayment":"broadband_amount"==_destination_div&&(_model="BroadbandBillPayment");var d="";"confirm"==result.data[r].display_value.replace(/ /g,"").split("_")[1]&&(d="checkConfirm");var c="",_="";result.data[r].display_value.toLowerCase().indexOf("mobile")>=0&&(c="mobileClass",_="checkNumber");var p=result.data[r].display_value.replace(/ /g,"_"),m=_model.toLowerCase()+"-"+p;"broadbandbillpayment-pakage_id"===m?l+='<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 customElectricityFields '+d+" "+c+' ">\n                                                <div class="required form-group"><select class="form-control  with-arrow" name="'+_model+"["+result.data[r].display_value+']" id="'+m+'"><option value="" data-price="0">Select Package</option></select><div class="help-block"></div></div>\n</div>':(1==result.data[r].is_service_no?(_isUnique="unique",_positionrelative="positionrelative"):(_isUnique="",_positionrelative=""),a("#broadbandbillpayment-pakage_id").parent().remove(),_element_id1=m.replace(/\.+/g,""),l+='<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 customElectricityFields '+d+" "+c+' ">\n                                                <div class="required form-group '+_positionrelative+'">\n<input type="text" placeholder="'+result.data[r].display_name+'" \n                                                name="'+_model+"["+result.data[r].display_value+']"\n                                                class="'+s+" form-control "+o+" "+t+" "+_+" "+_isUnique+'" id="'+_element_id1+'"\n                                                '+n+'><div class="help-block"></div></div>\n</div>',b+=result.data[r].display_value+","),i%2===1&&(l+='<div class="clearfix customElectricityFields"></div>'),i++}a(".customElectricityFields").remove(),a("#"+_destination_div).before(l),_billerData=a(".is-biller-data").html(),_billerData=a.parseJSON(_billerData),a.each(_billerData,function(e,t){t.id==_id&&(1==t.is_billdesk?(a(".biller_bill_fetch a").text("Fetch Bill"),1==t.partial_payment?a(".biller_bill_fetch").parent("div").find("input").prop("readonly",!0):a(".biller_bill_fetch").parent("div").find("input").prop("readonly",!1),a(".biller_bill_fetch a").removeClass("disabled")):(a(".biller_bill_fetch a").text(""),a(".biller_bill_fetch").parent("div").find("input").prop("readonly",!1),a(".biller_bill_fetch a").addClass("disabled")))})}}})):a(".customElectricityFields").remove()}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function s(e){var l=0;_element=e.data.elem;var i="";return e.data.isAmount!=t&&(i=e.data.isAmount),a("#"+_element).each(function(){var e=/^\d+$/;$field=a(this).find(".form-control");for(var t=a("#electricitybillpayment-enter_userid").val(),r=_js_error_msg.default_error_message,s=a(".cls-mxlen").length,o=0;s>o;o++){var d=a(".cls-mxlen:eq("+o+")"),c=d.attr("maxlength");0==d.val()&&d.val().length==c&&(d.siblings(".help-block").text("Invalid data."),d.parent().addClass("has-error"))}var _=0;if($field.val()>"0"&&$field.attr("id").indexOf("amount")>0)if(parseFloat($field.val())<parseInt(_ow_transaction_onetime_limit.min_amount))r=_js_error_msg.paybills_electricity_amount_min,_=1;else if(parseFloat($field.val())>parseInt(_ow_transaction_onetime_limit.ele_payment))r=_js_error_msg.paybills_electricity_amount_max,_=1;else{var p=/^\d+(\.\d{2})?\s*$/;p.test($field.val().toString())||(r=_js_error_msg.default_decimal_message,_=1)}""==$field.val()||0==$field.val()||1==_?($field.attr("id").indexOf("amount")>0?"0"!=i&&parseFloat($field.val())<1&&(r=_js_error_msg.paybills_electricity_amount_empty):$field.attr("id").indexOf("operator")>0?r=_js_error_msg.paybills_electricity_operator_empty:$field.attr("id").indexOf("consumer_id")>0?r=_js_error_msg.paybills_electricity_consumer_id_empty:$field.attr("id").indexOf("division")>0?r=_js_error_msg.paybills_electricity_division_empty:$field.attr("id").indexOf("sub_division")>0?r=_js_error_msg.paybills_electricity_subdivision_empty:$field.attr("id").indexOf("consumer_mobile")>0?r=_js_error_msg.paybills_electricity_cmobile_empty:$field.attr("id").indexOf("consumer_name")>0?r=_js_error_msg.paybills_electricity_cname_empty:$field.attr("id").indexOf("account_number")>0?r=_js_error_msg.paybills_electricity_account_empty:$field.attr("id").indexOf("ca_number")>0?r=_js_error_msg.paybills_electricity_ca_empty:$field.attr("id").indexOf("sdo_number")>0?r=_js_error_msg.paybills_electricity_sdo_empty:$field.attr("id").indexOf("binder_number")>0?r=_js_error_msg.paybills_electricity_binder_empty:$field.attr("id").indexOf("mobile_number")>0?r=_js_error_msg.paybills_electricity_mobile_empty:$field.attr("id").indexOf("consumer_id")>0?r=_js_error_msg.paybills_electricity_consumer_id_empty:$field.attr("id").indexOf("electricitybillpayment-enter_userid")>=0||0==t?(a("#electricitybillpayment-enter_userid").siblings(".help-block").text("Invalid User Id"),a("#electricitybillpayment-enter_userid").parent().removeClass("has-success").addClass("has-error")):$field.attr("id").indexOf("electricitybillpayment-mobile_no")>=0||0==a("#electricitybillpayment-mobile_no").val()?(a("#electricitybillpayment-mobile_no").siblings(".help-block").text("Invalid Mobile Number"),a("#electricitybillpayment-mobile_no").parent().removeClass("has-success").addClass("has-error")):$field.attr("id").indexOf("electricitybillpayment-pakage_id")>=0||0==a("#electricitybillpayment-pakage_id").val()?(a("#electricitybillpayment-pakage_id").siblings(".help-block").text("Invalid Package Id"),a("#electricitybillpayment-pakage_id").parent().removeClass("has-success").addClass("has-error")):$field.attr("data")||0!=a("#broadbandbillpayment-pakage_id").val()?$field.attr("id").indexOf("amount")>0?"0"!=i&&(r=n($field.attr("data").replace("_"," "))+_js_error_msg.default_empty_error_message):r=n($field.attr("data").replace("_"," "))+_js_error_msg.default_empty_error_message:(a("#broadbandbillpayment-pakage_id").siblings(".help-block").text("Please Select Package"),a("#broadbandbillpayment-pakage_id").parent().addClass("has-error")),$field.attr("id").indexOf("amount")>0?"0"!=i?($field.parents(".required").find(".help-block").html(r),$field.parents(".required").addClass("has-error")):($field.parents(".required").find(".help-block").html(""),$field.parents(".required").removeClass("has-error").addClass("has-success")):($field.parents(".required").find(".help-block").html(r),$field.parents(".required").addClass("has-error")),l=1):($field.parents(".required").find(".help-block").html(""),a(this).removeClass("has-error"),a(this).find(".customErrorMsg").remove(),1==$field.attr("is_numeric")&&(e.test($field.val())||(l=1,$field.parents(".required").addClass("has-error"),$field.after('<p class="help-block help-block-error customErrorMsg">Please fill correct '+$field.attr("placeholder")+"</p>"))))}),l?!1:!0}function o(e){_elem=e.data.elem_id,!a(".has-error").length>0?(a(".heading-inner > h1").html("Review"),a(this).parents(".row").find(".steps li:eq(1) a").addClass("active"),a(this).parents(".row").find("input").attr("readonly",!0),"el"==_elem?(a("#button-pay-electricity-bill").parent().addClass("hide"),a("#el_recharge_conf_container").removeClass("hide")):"bb"==_elem?(a("#button-pay-bb-bill").parent().addClass("hide"),a("#bb_recharge_conf_container").removeClass("hide")):"gas"==_elem&&(a("#button-pay-gas-bill").parent().addClass("hide"),a("#gas_recharge_conf_container").removeClass("hide")),a("button-pay-electricity-bill").parents(".row").find(".steps li:eq(1) a").addClass("active"),a(".recharge-bills-home h1").html("Review")):"el"==_elem?(a("#button-pay-electricity-bill").parent().removeClass("hide"),a("#el_recharge_conf_container").addClass("hide")):"bb"==_elem?(a("#button-pay-bb-bill").parent().removeClass("hide"),a("#bb_recharge_conf_container").addClass("hide")):"gas"==_elem&&(a("#button-pay-gas-bill").parent().removeClass("hide"),a("#gas_recharge_conf_container").addClass("hide"))}function d(e){a("#el_recharge_sub_container").hasClass("hide")&&(a("#el_recharge_conf_container").addClass("hide"),a("#el_recharge_sub_container").removeClass("hide")),a("#gas_recharge_sub_container").hasClass("hide")&&(a("#gas_recharge_conf_container").addClass("hide"),a("#gas_recharge_sub_container").removeClass("hide")),a("#bb_recharge_sub_container").hasClass("hide")&&(a("#bb_recharge_conf_container").addClass("hide"),a("#bb_recharge_sub_container").removeClass("hide")),a(".heading-inner > h1").html("Recharge & PayBills"),a(this).parents(".row").find(".steps li:eq(1) a").removeClass("active"),a(this).parents(".row").find(".steps li:eq(0) a").addClass("active"),a(this).parents(".row").find("input").attr("readonly",!1),a(".recharge-bills-home h1").html("Recharge & PayBills")}function c(e){a("#elc-rec-sub-loader").removeClass("hide")}function _(){$electricity=a("#electricitybillpayment-operator"),$electricity_pay=a("#button-pay-electricity-bill"),$broadband=a("#broadbandbillpayment-operator"),$broadband_pay=a("#button-pay-bb-bill"),$gas=a("#gasbillpayment-operator"),$gas_pay=a("#button-pay-gas-bill");a(".integerOnly");$electricity.on("change",{container:"electricity_amount"},r),$broadband.on("change",{container:"broadband_amount"},r),$gas.on("change",{container:"gas_amount"},r),$electricity_pay.on("click",{elem:"form-pay-electricity-bill .form-group"},s),$gas_pay.on("click",{elem:"form-pay-gas-bill .form-group"},s),$broadband_pay.on("click",{elem:"form-pay-bb-bill .form-group"},s),a("#button-el-confirm-recharge").on("click",{elem_id:"el"},c),$electricity_pay.on("click",{elem_id:"el"},o),$gas_pay.on("click",{elem_id:"gas"},o),$broadband_pay.on("click",{elem_id:"bb"},o),a("#form-pay-electricity-bill #frm_btn_skip").on("click",{frm:"mobile",elem_id:"el_recharge_sub_container"},d),a("#form-pay-gas-bill #frm_btn_skip").on("click",{frm:"gas",elem_id:"gas_recharge_sub_container"},d),a("#form-pay-bb-bill #frm_btn_skip").on("click",{frm:"bb",elem_id:"bb_recharge_sub_container"},d)}var p=0,b="";a(document).on("click",".biller_bill_fetch a",{"default":!1},e),a(".biller_bill_fetch a").text(""),a(window).bind("resize load",function(){a(this).width()<767&&a(document).on("keypress",".integerOnly",function(){a(this).attr("type","tel")})});var m=1;String.prototype.replaceAll=function(e,a){var t=this;return t.replace(new RegExp(e,"g"),a)},a(document).on("keypress","#electricitybillpayment-enter_userid",function(e){var a=window.event?e.keyCode:e.which;return!(8==a||a==t||0==e.which?null:String.fromCharCode(a).match(/[^a-zA-Z0-9 ]/g))}),a(document).on("change","#broadbandbillpayment-pakage_id",function(e){package_price=parseInt(a("#broadbandbillpayment-pakage_id :selected").attr("data-price")),a("#broadbandbillpayment-amount").val(package_price)}),a(document).on("click","#mobprepaid,#mobpostpaid",function(){setTimeout(function(){a("#broadbandbillpayment-operator").val(""),a("#broadbandbillpayment-amount").val(""),a("#broadbandbillpayment-enter_userid").val(""),a("#broadbandbillpayment-pakage_id").empty().html('<option value="0" data-price="">Select Package</option>'),a("#broadbandbillpayment-mobile_no").val("")},2e3)}),a(document).on("keyup","#broadbandbillpayment-mobile_no",function(){var e=a("#broadbandbillpayment-operator :selected").text(),t=(a("#broadbandbillpayment-operator :selected").val(),a("#broadbandbillpayment-enter_userid").val()),l=a("#broadbandbillpayment-mobile_no").val(),i=l.length,r=a('#form-pay-bb-bill input[type="radio"]:checked').val();"DEN"==e.toUpperCase()&&t.length>4&&10==i&&(a("#elc-rec-sub-loader").removeClass("hide"),a(".popup-loader").removeClass("hide"),a.ajax({url:"/paybills/broadband-bill-payment/package-details",method:"post",data:{user_id:t,utility_plan_type:1,entered_mdn:l,selected_mode:r,_csrf:a("input[name=_csrf]").val()},success:function(e){a("#elc-rec-sub-loader").addClass("hide"),a(".popup-loader").addClass("hide"),jsonResponse=JSON.parse(e),u_options='<option value="0" data-price="">Select Package</option>',"success"==jsonResponse.status?(jsonResponse.data[0].plan_list&&a.each(jsonResponse.data[0].plan_list,function(e,a){pkg_details=a.TextField,pkg=pkg_details.split("#"),u_options=u_options+"<option data-price="+a.ValueField+' value="'+pkg[1].replace(/[^0-9\.]/g,"")+'">'+pkg[1]+"</option>"}),a("#broadbandbillpayment-pakage_id").html(u_options)):a("#broadbandbillpayment-pakage_id").empty().html('<option value="0" data-price="">Select Package</option>')}}))}),a(document).on("blur",'#form-pay-electricity-bill input[type="text"],#form-pay-bb-bill input[type="text"], #form-pay-gas-bill input[type="text"]',function(){var e=a(this).val(),t=a(this).attr("id").split("-")[1]+" can not be blank",l=t.replaceAll("_"," ");l=n(l),""!=e?a(this).siblings(".help-block").text("").parent().removeClass("has-error").addClass("has-success"):a(this).siblings(".help-block").text(l).parent().addClass("has-error").removeClass("has-success")}),a(document).on("blur","#electricitybillpayment-consumer_id",function(){var e=a(this).val();/^\d+$/.test(e)||""==e?""!=e&&(a(this).siblings(".help-block").text(_js_error_msg.paybills_electricity_consumer_id_alphabet).parent().addClass("has-error").removeClass("has-success"),m=0):(a(this).siblings(".help-block").text("").parent().removeClass("has-error").addClass("has-success"),m=1)}),a("body").click(function(e){e.originalEvent!==t&&(a(e.target).closest(".ai-inti").length||a(e.target).closest(".integerOnly").length||a(e.target).closest(".unique").length||a(".ai-inti").remove())}),_uniqueArray="",_records="",_type="",_fillData="",a(document).on("click",".bill-unique",function(){p=1,_type=a(this).attr("data-type"),a(this).parents(".ai-inti").remove(),_dataArray=a(this).attr("data-unique"),_dataArray=_dataArray.split("|"),_fillData=_dataArray[1],a("#"+_type+"billpayment-operator").val(_dataArray[0]),r({data:{container:_type+"_amount"}},a("#"+_type+"billpayment-operator"))}),this.init=function(){_(),a("#electricitybillpayment-operator").val()?r({data:{container:"electricity_amount"}},a("#electricitybillpayment-operator")):a("#broadbandbillpayment-operator").val()?r({data:{container:"broadband_amount"}},a("#broadbandbillpayment-operator")):a("#gasbillpayment-operator").val()&&r({data:{container:"gas_amount"}},a("#gasbillpayment-operator"))}}return new e}(),a(document).ready(function(){e.payBills.init()})}(window.OXIGENWALLET=window.OXIGENWALLET||{},jQuery);